<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Single Page Web Application</title>
  <style>
    :root{
      --bg: #0f172a;        /* slate-900 */
      --card: #111827;      /* gray-900 */
      --muted: #94a3b8;     /* slate-400 */
      --text: #e5e7eb;      /* gray-200 */
      --brand: #6366f1;     /* indigo-500 */
      --brand-2: #22d3ee;   /* cyan-400 */
      --accent: #10b981;    /* emerald-500 */
      --danger: #ef4444;    /* red-500 */
      --shadow: 0 10px 25px rgba(0,0,0,.35);
      --radius: 18px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      color: var(--text); background: radial-gradient(1200px 600px at 10% 0%, rgba(99,102,241,.20), transparent),
                           radial-gradient(900px 500px at 90% 10%, rgba(34,211,238,.18), transparent),
                           var(--bg);
      min-height:100%;
    }
    .container{max-width:1100px;margin-inline:auto;padding:24px}
    header{
      display:flex; align-items:center; gap:16px; justify-content:space-between; 
      position: sticky; top:0; backdrop-filter: blur(8px); background: rgba(15, 23, 42, .6); 
      padding:16px 24px; border:1px solid rgba(148,163,184,.15); border-radius: var(--radius);
      box-shadow: var(--shadow);
    }
    .brand{display:flex; align-items:center; gap:12px; font-weight:700; letter-spacing:.3px}
    .logo{width:36px;height:36px;border-radius:12px;background:linear-gradient(135deg,var(--brand),var(--brand-2));display:grid;place-items:center;color:#0b1020;font-weight:900;}
    nav{display:flex; gap:8px; flex-wrap:wrap}
    nav a{color:var(--text); text-decoration:none; padding:10px 14px; border-radius:12px; border:1px solid transparent}
    nav a.active, nav a:hover{border-color: rgba(99,102,241,.35); background: rgba(99,102,241,.12)}

    main{margin-top:20px}
    .card{background:linear-gradient(180deg, rgba(17,24,39,.8), rgba(17,24,39,.6)); border:1px solid rgba(148,163,184,.15);
          border-radius: var(--radius); padding:24px; box-shadow: var(--shadow)}
    .grid{display:grid; gap:20px}
    @media(min-width: 900px){ .grid{grid-template-columns: 1.1fr .9fr} }
    h1{font-size:clamp(26px, 2.6vw, 36px); margin:0 0 6px}
    h2{font-size:clamp(20px, 2.1vw, 26px); margin:0 0 14px}
    p{color:var(--muted); line-height:1.6}
    .muted{color:var(--muted)}

    /* Components */
    .toolbar{display:flex; gap:10px; flex-wrap:wrap}
    .input, .select{background:#0b1020;border:1px solid rgba(148,163,184,.25); color:var(--text);
      padding:10px 12px; border-radius:12px; outline:none}
    .input:focus{border-color: rgba(34,211,238,.5)}
    .btn{cursor:pointer;border:1px solid rgba(148,163,184,.25); background: linear-gradient(180deg, rgba(99,102,241,.25), rgba(99,102,241,.15));
      color:var(--text); padding:10px 14px; border-radius:12px; transition:.2s transform ease; font-weight:600}
    .btn:hover{transform: translateY(-1px)}
    .btn.ghost{background:transparent}
    .btn.danger{background: linear-gradient(180deg, rgba(239,68,68,.25), rgba(239,68,68,.15)); border-color: rgba(239,68,68,.35)}

    .list{display:grid; gap:10px; margin-top:10px}
    .item{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px 14px; border-radius:12px;
          background: #0b1020; border:1px solid rgba(148,163,184,.15)}
    .item small{color:var(--muted)}
    .badges{display:flex; gap:8px; flex-wrap:wrap}
    .badge{font-size:12px;padding:4px 8px;border-radius:999px;border:1px solid rgba(148,163,184,.25); background: rgba(255,255,255,.03)}

    footer{margin:30px 0; text-align:center; color:var(--muted)}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <div class="logo">SPA</div>
        <div>
          <div>Single Page App</div>
          <small class="muted">Vanilla JS â€¢ No frameworks</small>
        </div>
      </div>
      <nav>
        <!-- Hash-based routes -->
        <a href="#/" data-route>Home</a>
        <a href="#/tasks" data-route>Tasks</a>
        <a href="#/about" data-route>About</a>
      </nav>
    </header>

    <main id="app" class="grid" aria-live="polite"></main>

    <footer>Built as a single <code>index.html</code> file. Data persists in <code>localStorage</code>.</footer>
  </div>

  <template id="home-view">
    <section class="card">
      <h1>Welcome ðŸ‘‹</h1>
      <p>This is a minimal single page web application (SPA) using <strong>one HTML file</strong>, 
         hash-based routing, and basic state management. Use it as a starter for your project.</p>
      <div class="badges" style="margin-top:12px">
        <span class="badge">Router</span>
        <span class="badge">LocalStorage</span>
        <span class="badge">Components</span>
        <span class="badge">Accessible</span>
      </div>
    </section>
    <section class="card">
      <h2>Quick Start</h2>
      <ol class="muted">
        <li>Open this file in a browserâ€”no server needed.</li>
        <li>Edit the <code>render()</code> functions below to customize views.</li>
        <li>Deploy anywhere (GitHub Pages, Netlify, Vercel).</li>
      </ol>
      <div style="margin-top:12px" class="toolbar">
        <button class="btn" id="demoAdd">Add demo tasks</button>
        <button class="btn ghost" id="demoClear">Clear all data</button>
      </div>
    </section>
  </template>

  <template id="tasks-view">
    <section class="card" style="grid-column: 1 / -1;">
      <h1>Tasks</h1>
      <p class="muted">Add, toggle, filter and delete tasks. State is persisted locally.</p>

      <div class="toolbar" style="margin:12px 0 6px">
        <label>
          <span class="sr-only">Task title</span>
          <input class="input" id="taskTitle" placeholder="What needs to be done?" />
        </label>
        <select id="taskPriority" class="select">
          <option value="normal">Normal</option>
          <option value="high">High</option>
          <option value="low">Low</option>
        </select>
        <button class="btn" id="addTask">Add Task</button>
        <button class="btn danger" id="clearCompleted">Clear Completed</button>
        <select id="filter" class="select">
          <option value="all">All</option>
          <option value="active">Active</option>
          <option value="completed">Completed</option>
        </select>
      </div>

      <div id="taskList" class="list" role="list"></div>
    </section>
  </template>

  <template id="about-view">
    <section class="card">
      <h1>About</h1>
      <p>This SPA demonstrates a clean architecture without any build tools:</p>
      <ul class="muted">
        <li><strong>Router:</strong> Listens to <code>hashchange</code> and swaps views.</li>
        <li><strong>State:</strong> Stored and synced via <code>localStorage</code>.</li>
        <li><strong>Components:</strong> Small functions that return DOM elements.</li>
        <li><strong>Accessibility:</strong> Live region updates and semantic controls.</li>
      </ul>
      <p>Feel free to repurpose this for projects like notes, movie tickets, inventory, etc.</p>
    </section>
  </template>

  <script>
    // --- Simple Store -------------------------------------------------------
    const Store = {
      key: 'spa.tasks.v1',
      get(){
        try { return JSON.parse(localStorage.getItem(this.key)) ?? []; }
        catch { return []; }
      },
      set(tasks){ localStorage.setItem(this.key, JSON.stringify(tasks)); },
      clear(){ localStorage.removeItem(this.key); }
    };

    // --- Utilities ----------------------------------------------------------
    const $ = (sel, scope=document) => scope.querySelector(sel);
    const $$ = (sel, scope=document) => Array.from(scope.querySelectorAll(sel));
    const uid = () => Math.random().toString(36).slice(2,9);

    // --- Components ---------------------------------------------------------
    function TaskItem(task, onToggle, onDelete){
      const el = document.createElement('div');
      el.className = 'item';
      const left = document.createElement('div');
      left.style.display = 'flex';
      left.style.alignItems = 'center';
      left.style.gap = '10px';

      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.checked = !!task.done;
      checkbox.ariaLabel = 'Toggle task completion';
      checkbox.addEventListener('change', () => onToggle(task.id));

      const title = document.createElement('div');
      title.innerHTML = `<strong>${escapeHtml(task.title)}</strong><br><small>${task.priority} priority</small>`;
      if(task.done){ title.style.textDecoration = 'line-through'; title.style.opacity = .7; }

      left.append(checkbox, title);

      const right = document.createElement('div');
      right.className = 'badges';
      const badge = document.createElement('span');
      badge.className = 'badge';
      badge.textContent = new Date(task.created).toLocaleString();

      const del = document.createElement('button');
      del.className = 'btn danger';
      del.textContent = 'Delete';
      del.addEventListener('click', () => onDelete(task.id));

      right.append(badge, del);

      el.append(left, right);
      return el;
    }

    function escapeHtml(str){
      return str.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;');
    }

    // --- Views --------------------------------------------------------------
    const Views = {
      home(){
        const tpl = document.getElementById('home-view');
        const frag = tpl.content.cloneNode(true);
        // Demo buttons
        frag.getElementById('demoAdd').addEventListener('click', () => {
          const samples = [
            {title:'Design landing page', priority:'high'},
            {title:'Study DSA for 30 min', priority:'normal'},
            {title:'Call library', priority:'low'}
          ];
          const now = Date.now();
          const items = Store.get();
          samples.forEach((s,i) => items.push({id:uid(), title:s.title, priority:s.priority, created: now + i, done:false}));
          Store.set(items);
          Router.render();
        });
        frag.getElementById('demoClear').addEventListener('click', () => { Store.clear(); Router.render(); });
        return frag;
      },

      tasks(){
        const tpl = document.getElementById('tasks-view');
        const frag = tpl.content.cloneNode(true);

        const $title = frag.getElementById('taskTitle');
        const $priority = frag.getElementById('taskPriority');
        const $list = frag.getElementById('taskList');
        const $filter = frag.getElementById('filter');

        const renderList = () => {
          $list.innerHTML = '';
          let tasks = Store.get();
          const mode = $filter.value;
          if(mode === 'active') tasks = tasks.filter(t=>!t.done);
          if(mode === 'completed') tasks = tasks.filter(t=>t.done);
          if(tasks.length === 0){
            const empty = document.createElement('p');
            empty.className = 'muted';
            empty.textContent = 'No tasks yet. Add one above!';
            $list.append(empty);
            return;
          }
          tasks.sort((a,b) => Number(a.done) - Number(b.done));
          tasks.forEach(t => $list.append(
            TaskItem(t, (id)=>{
              const all = Store.get().map(x => x.id===id? {...x, done:!x.done}: x);
              Store.set(all); renderList();
            }, (id)=>{
              const all = Store.get().filter(x => x.id!==id);
              Store.set(all); renderList();
            })
          ));
        };

        frag.getElementById('addTask').addEventListener('click', () => {
          const title = $title.value.trim();
          if(!title) return alert('Please enter a task title');
          const tasks = Store.get();
          tasks.push({ id: uid(), title, priority: $priority.value, created: Date.now(), done:false });
          Store.set(tasks);
          $title.value = '';
          renderList();
        });

        frag.getElementById('clearCompleted').addEventListener('click', () => {
          const keep = Store.get().filter(t=>!t.done);
          Store.set(keep); renderList();
        });

        $filter.addEventListener('change', renderList);
        // initial render
        setTimeout(renderList, 0);
        return frag;
      },

      about(){
        return document.getElementById('about-view').content.cloneNode(true);
      }
    };

    // --- Router -------------------------------------------------------------
    const Router = {
      routes: {
        '/': Views.home,
        '/tasks': Views.tasks,
        '/about': Views.about,
      },
      currentPath(){ return (location.hash.slice(1) || '/').split('?')[0]; },
      navigate(path){ location.hash = '#' + path; },
      setActiveLink(){
        $$('a[data-route]').forEach(a => {
          const path = new URL(a.href).hash.slice(1) || '/';
          a.classList.toggle('active', path === Router.currentPath());
        });
      },
      render(){
        const view = this.routes[this.currentPath()] || Views.home;
        const root = document.getElementById('app');
        root.innerHTML = '';
        root.append(view());
        this.setActiveLink();
        // Announce for screen readers
        root.setAttribute('aria-busy','false');
      },
      start(){
        window.addEventListener('hashchange', ()=> this.render());
        this.render();
      }
    };

    // Boot
    Router.start();
  </script>
</body>
</html>
